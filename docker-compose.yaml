version: "3.0"
services:
  undb:
    build:
      context: .
      dockerfile: Dockerfile.dev
    container_name: undb
    volumes:
      - .:/app
      - /app/node_modules
    ports:
      - 3721:3721
    environment:
      - UNDB_DB_TURSO_URL=http://db:8080
    depends_on:
      - db

  db:
    image: ghcr.io/tursodatabase/libsql-server:latest
    # ports:
    #   - "8080:8080"
    #   - "5001:5001"
    environment:
      - SQLD_NODE=primary
    volumes:
      - ./apps/backend/.undb:/var/lib/sqld
